FROM python:3.13-alpine3.21

ARG USERNAME=alex
ARG USER_UID=1000
ARG USER_GID=$USER_UID

# Create the user
RUN apk add --no-cache bash git sudo \
    && addgroup -g ${USER_GID} -S ${USERNAME} \
    && adduser -D -u ${USER_UID} -G ${USERNAME} -h /home/${USERNAME} -s /bin/bash ${USERNAME} \
    && echo "${USERNAME} ALL=(ALL) NOPASSWD:ALL" > /etc/sudoers.d/${USERNAME} \
    && chmod 0440 /etc/sudoers.d/${USERNAME}

RUN apk add --no-cache git bash 

COPY requirements.txt requirements.txt

RUN pip install -r requirements.txt

USER $USERNAME